// === LOGIN USER (Kode yang Diperbaiki) ===
function loginUser(data) {
  const sheet = getSheetByNameOrThrow(sheetUsersName);
  const users = sheet.getDataRange().getValues();
  
  const inputUsername = data.username ? data.username.trim() : '';
  const inputPassword = data.password ? data.password.trim() : '';

  for (let i = 1; i < users.length; i++) {
    const userRow = users[i];
    
    // Pastikan kita mengambil nilai dari kolom A (index 0) dan B (index 1)
    const storedUsername = (userRow[0] || '').toString().trim();
    const storedPassword = (userRow[1] || '').toString().trim();
    
    if (storedUsername === inputUsername && storedPassword === inputPassword) {
      // Login berhasil, kita bisa mengembalikan peran (role) juga jika mau
      const role = (userRow[2] || '').toString().trim(); 
      return { success: true, message: "Login berhasil", user: { username: storedUsername, role: role } };
    }
  }
  return { success: false, message: "Username atau password salah" };
}
